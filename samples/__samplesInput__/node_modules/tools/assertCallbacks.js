/**
 * Use this carefully. Things need to be tuned and dbux-disabled just right for this to work.
 * Also this module must make the whitelist, else passing cbs to it will lead to automatic patching.
 * 
 * future-work: configure callback patching behavior via comments - but even then, whitelist is still necessary.
 */


const assert = {
  patched(cb, not = false) {
    let isPatched = /* dbux disable */ __dbux__.r.callbackPatcher.isPatched(cb);

    if (isPatched !== !not) {
      console.trace(`❌  ${cb.name} is ${isPatched ? 'patched (but expected not to be)' : 'not patched (but expected to)'}`);
    }
    else {
      console.log(`✔️  ${cb.name} is ${isPatched ? 'patched' : 'not patched'}`);
    }
  },

  not: {
    patched(cb) {
      return assert.patched(cb, true);
    }
  }
};

module.exports = assert;